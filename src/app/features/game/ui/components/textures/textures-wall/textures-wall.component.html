<svg [attr.viewBox]="svgViewBox" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"
  style="position: absolute; bottom: 0; left: 0; width: 100%"
  [attr.class]="wallType + ' wall-position-' + wallPosition">
  <defs>
    @if(wallType === 'cave') {
    <pattern [id]="textureId" x="0" y="100%" width="50" height="70" patternUnits="userSpaceOnUse"
      [attr.patternTransform]="'scale(' + (wallPosition === 'r' ? -1 : 1) + ', 1)'">
      <rect class="bgRect" width="50" height="70" x="0" y="0" />
      <path class="crack-light"
        d="M 0,0 5.124646,5.5163772 9.123938,4.4212998 16.9213,10.781692 27.250708,11.796654 29.843308,9.8575608 31.169884,17.483977 43.75,21.875 50,25" />
      <path class="crack-dark"
        d="m 0,55.5 11.314093,1.999646 -1.7681473,2.984331 10.1887393,7.907754 2.029922,3.406339 5.124647,-1.798424 4.28063,2.984331 8.360039,0.592953 L 50,80.5" />
      <path class="crack-light" d="m 0,30 5,2.5 6.255282,0.568796 L 15,37.5 l 3.744718,0.08599" />
      <path class="crack-dark" d="m 22.880705,26 5,2.5 6.255282,0.568796 4.816848,4.724199" />
      <path class="crack-light" d="M 36.759213,44.710319 40,50 50,55" />
      <path class="crack-dark" d="m 5.8052063,48.852938 4.0759708,-0.977267 9.9999999,5" />
    </pattern>
    } @else if (wallType === 'blue-shine') {
    <pattern [id]="textureId" x="0" y="100%" width="50" height="50" patternUnits="userSpaceOnUse"
      [attr.patternTransform]="'scale(' + (wallPosition === 'r' ? -1 : 1) + ', 1)'">
      <rect class="bgRect" width="50" height="325" x="0" y="0" />

      <g>
        <path class="facet-01" d="M 0,-12.5 V 0 l 8.333333,-8.333334 z" id="path262" />
        <path class="facet-01" d="M 0,0 8.333333,16.666666 0,12.5 Z" id="path228" />
        <path class="facet-01" d="M 0,37.5 V 50 l 8.333333,-8.333334 z" id="path243" />
        <path class="facet-01" d="M 16.66667,8.333335 25,25 33.33334,16.66667 Z" id="path219" />
        <path class="facet-01" d="M 25,25 41.66667,33.333335 33.33334,16.66667 Z" id="path220" />
        <path class="facet-01" d="M 33.33334,-8.33333 50,0 41.66667,8.333335 Z" id="path258" />
        <path class="facet-01" d="M 33.33334,41.66667 50,50 41.66667,58.333335 Z" id="path239" />
        <path class="facet-01" d="M 41.66667,58.333335 50,75 V 62.5 Z" id="path245" />
        <path class="facet-01" d="M 41.66667,8.333335 50,25 V 12.5 Z" id="path264" />
        <path class="facet-01" d="M 50,25 V 37.5 L 41.66667,33.333335 Z" id="path230" />
        <path class="facet-01" d="M 8.333333,16.666666 16.66667,33.333335 0,25 Z" id="path224" />
        <path class="facet-02" d="M 0,-25 8.333333,-8.333334 0,-12.5 Z" id="path261" />
        <path class="facet-02" d="M 0,25 8.333333,41.666666 0,37.5 Z" id="path242" />
        <path class="facet-02" d="M 16.66667,-16.666665 0,-25 8.333333,-8.333334 Z" id="path259" />
        <path class="facet-02" d="M 16.66667,-16.666665 25,0 33.33334,-8.33333 Z" id="path253" />
        <path class="facet-02" d="M 16.66667,33.333335 0,25 8.333333,41.666666 Z" id="path240" />
        <path class="facet-02" d="M 16.66667,33.333335 25,50 33.33334,41.66667 Z" id="path233" />
        <path class="facet-02" d="M 16.66667,8.333335 25,25 8.333333,16.666666 Z" id="path221" />
        <path class="facet-02" d="m 25,25 8.33334,16.66667 8.33333,-8.333335 z" id="path232" />
        <path class="facet-02" d="M 33.33334,16.66667 50,25 41.66667,33.333335 Z" id="path225" />
        <path class="facet-02" d="M 41.66667,33.333335 50,50 33.33334,41.66667 Z" id="path223" />
        <path class="facet-02" d="M 50,0 V 12.5 L 41.66667,8.333335 Z" id="path263" />
        <path class="facet-02" d="M 50,50 V 62.5 L 41.66667,58.333335 Z" id="path244" />
        <path class="facet-02" d="M 8.333333,-8.333334 16.66667,8.333335 0,0 Z" id="path257" />
        <path class="facet-02" d="M 8.333333,-8.333334 16.66667,8.333335 25,0 Z" id="path260" />
        <path class="facet-02" d="M 8.333333,41.666666 16.66667,58.333335 0,50 Z" id="path238" />
        <path class="facet-02" d="M 8.333333,41.666666 16.66667,58.333335 25,50 Z" id="path241" />
      </g>

    </pattern>
    } @else if (wallType === 'red-stone') {
    <pattern [id]="textureId" x="0" y="100%" width="50" height="50" patternUnits="userSpaceOnUse"
      [attr.patternTransform]="'scale(' + (wallPosition === 'r' ? -1 : 1) + ', 1)'">

      <rect class="bgRect" width="50" height="325" x="0" y="0" />

      <g transform="translate(0,23)">
        <path
          style="display:inline;fill:#742020;fill-opacity:1;stroke:#2a2119;stroke-width:0;stroke-linecap:round;stroke-linejoin:round;paint-order:stroke fill markers"
          d="M 6.1235512,6.3784886 43.876448,25.149171 C 46.507609,26.45738 49,28.89131 49,31.815541 v 11.665552 c 0,2.92423 -2.492392,5.198627 -5.123552,3.890418 L 6.1235512,28.600828 C 3.4923921,27.29262 1,24.858691 1,21.93446 V 10.268908 C 1,7.3446779 3.4923918,5.0702802 6.1235512,6.3784886 Z" />
        <path
          style="display:inline;fill:#661d1d;fill-opacity:1;stroke:none;stroke-width:0;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
          d="m 2.8531293,19 c 0,0 -2.370666,5.068736 5.1728185,8.586069 C 12.263608,29.561981 34.894226,41.519071 37.10925,42.159111 22.556978,30.579555 5.6490779,27.782189 2.8531293,19 Z" />
        <path
          style="fill:#882d2d;fill-opacity:1;stroke:none;stroke-width:0;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
          d="m 46.154787,34.454556 c 0,0 2.370666,-5.068736 -5.172819,-8.586069 C 36.744307,23.892575 14.113689,11.935484 11.898665,11.295444 29.655961,24.07171 43.876448,25.149171 46.154787,34.454556 Z" />
      </g>
      <g>
        <g transform="matrix(0.99375,0,0,1,25.00625,13.09956)">
          <path class="base"
            d="M 25,12.763823 6.1230469,3.3790571 C 3.4918901,2.0708502 1,3.3453042 1,6.2695312 V 7.9335938 C 1,10.857822 3.49189,13.293356 6.1230469,14.601562 L 25,23.986328 Z" />
          <path class="highlight"
            d="M 25,13.732422 C 18.792488,10.55067 12.966017,7.6034031 11.898438,7.2949219 16.564226,10.651928 20.975045,13.189841 25,15.292969 Z" />
          <path class="shadow"
            d="M 25,20.896484 C 14.190137,15.004441 4.4451982,11.77296 2.3828125,5.2949219 c 0,0 -2.37160198,5.0686081 5.171875,8.5859371 C 9.9139507,14.980923 17.93568,19.153416 25,22.765625 Z" />
        </g>
        <g transform="translate(-25,-11.763672)">
          <path class="base"
            d="m 25,12.763289 v 11.223039 l 18.876953,9.384766 C 46.50811,34.679301 49,32.404696 49,29.480469 v -1.664063 c 0,-2.924228 -2.491889,-4.360144 -5.123047,-5.668351 z" />
          <path class="shadow"
            d="m 25,20.896484 v 1.869141 c 5.624456,2.875961 10.656836,5.405748 11.638672,5.689453 C 32.82066,25.417004 28.844908,22.992197 25,20.896484 Z" />
          <path class="highlight"
            d="m 25,13.732422 v 1.560547 c 11.293408,5.901054 19.474601,8.301754 21.154297,15.162109 0,0 2.371602,-5.068608 -5.171875,-8.585937 C 38.787199,20.845565 31.67188,17.152192 25,13.732422 Z" />
        </g>
        <g>
          <path class="base" transform="matrix(0.90407226,0.42737963,0,1,0,0)"
            d="M 3.8406333,14.008648 H 9.624741 c 1.706592,0 3.080491,1.373899 3.080491,3.080491 v 3.75467 c 0,1.706592 -1.373899,3.080491 -3.080491,3.080491 H 3.8406333 c -1.7065922,0 -3.08049133,-1.373899 -3.08049133,-3.080491 v -3.75467 c 0,-1.706592 1.37389913,-3.080491 3.08049133,-3.080491 z" />
          <path class="base" transform="matrix(0.90407226,0.42737963,0,1,0,0)"
            d="m 45.431268,14.803445 h 5.784108 c 1.706592,0 3.080491,1.373899 3.080491,3.080491 v 3.75467 c 0,1.706592 -1.373899,3.080491 -3.080491,3.080491 h -5.784108 c -1.706592,0 -3.080491,-1.373899 -3.080491,-3.080491 v -3.75467 c 0,-1.706592 1.373899,-3.080491 3.080491,-3.080491 z" />
          <path class="base" transform="matrix(0.90407226,0.42737963,0,1,0,0)"
            d="m 17.747413,14.139111 19.901034,0.348074 c 1.693721,0.02962 3.080491,1.373899 3.080491,3.080491 v 3.754669 c 0,1.706593 -1.38677,3.110116 -3.080491,3.080492 L 17.747413,24.054763 c -1.693721,-0.02962 -3.080491,-1.373899 -3.080491,-3.080492 v -3.754669 c 0,-1.706592 1.38677,-3.110115 3.080491,-3.080491 z" />
          <path class="shadow"
            d="m 1.9311362,20.27693 c 0,0 0.241392,1.110404 0.9655681,2.172529 0.7241761,1.062124 1.6897443,2.41392 1.6897443,2.41392 0,0 -1.5931874,-0.289671 -2.4139204,-1.593188 C 1.3517953,21.966674 1.9311362,20.27693 1.9311362,20.27693 Z" />
          <path class="shadow"
            d="m 14.750899,26.600295 c 0,0 0.241392,1.110404 0.965568,2.172529 0.724176,1.062124 5.358903,4.200221 5.358903,4.200221 0,0 -5.262346,-2.075972 -6.083079,-3.379489 -0.820733,-1.303517 -0.241392,-2.993261 -0.241392,-2.993261 z" />
          <path class="shadow"
            d="m 39.708252,39.137727 c 0,0 0.241392,1.110404 0.965568,2.172529 0.724176,1.062124 1.689745,2.41392 1.689745,2.41392 0,0 -1.593188,-0.289671 -2.413921,-1.593188 -0.820733,-1.303517 -0.241392,-2.993261 -0.241392,-2.993261 z" />
          <path class="highlight"
            d="m 43.257452,36.546754 c 0,0 2.848426,0.579341 3.862273,2.075971 1.013846,1.496631 0.820733,2.896705 0.820733,2.896705 0,0 -0.531063,-1.20696 -1.738023,-2.655313 -0.840763,-1.008916 -2.944983,-2.317363 -2.944983,-2.317363 z" />
          <path class="highlight"
            d="m 5.8413182,18.282563 c 0,0 2.848426,0.579341 3.862273,2.075971 1.0138458,1.496631 0.8207328,2.896705 0.8207328,2.896705 0,0 -0.5310628,-1.20696 -1.7380228,-2.655313 -0.840763,-1.008916 -2.944983,-2.317363 -2.944983,-2.317363 z" />
          <path class="shadow"
            d="m 26.042277,28.427766 c 0,0 7.57971,2.896705 8.593557,4.393335 1.013846,1.496631 0.820733,3.620881 0.820733,3.620881 0,0 -1.062125,-2.655312 -2.848426,-3.95883 -1.060883,-0.774158 -6.565864,-4.055386 -6.565864,-4.055386 z" />
        </g>
        <g transform="translate(0,-27)">
          <path class="base"
            d="M 6.1235512,6.3784886 43.876448,25.149171 C 46.507609,26.45738 49,28.89131 49,31.815541 v 11.665552 c 0,2.92423 -2.492392,5.198627 -5.123552,3.890418 L 6.1235512,28.600828 C 3.4923921,27.29262 1,24.858691 1,21.93446 V 10.268908 C 1,7.3446779 3.4923918,5.0702802 6.1235512,6.3784886 Z" />
          <path class="shadow"
            d="m 2.8531293,19 c 0,0 -2.370666,5.068736 5.1728185,8.586069 C 12.263608,29.561981 34.894226,41.519071 37.10925,42.159111 22.556978,30.579555 5.6490779,27.782189 2.8531293,19 Z" />
          <path class="highlight"
            d="m 46.154787,34.454556 c 0,0 2.370666,-5.068736 -5.172819,-8.586069 C 36.744307,23.892575 14.113689,11.935484 11.898665,11.295444 29.655961,24.07171 43.876448,25.149171 46.154787,34.454556 Z" />
        </g>
      </g>

    </pattern>
    } @else if (wallType === 'blue-shine') {
    } @else {
    <pattern [id]="textureId" x="0" y="100%" width="50" height="50" patternUnits="userSpaceOnUse"
      [attr.patternTransform]="'scale(' + (wallPosition === 'r' ? -1 : 1) + ', 1)'">
      <rect x="0" y="0" width="100" height="50" class="bgRect" />
      @for(i of halfUnits.slice(0,6); track i; let idx = $index) {
      <line x1="0" [attr.y1]="i" x2="100" [attr.y2]="i + 50" class="brick" />
      @if((h + idx) % 2 === 0) {
      <!-- EVEN -->
      <line [attr.x1]="0" [attr.y1]="i" [attr.x2]="0" [attr.y2]="i - 12.5" class="brick" />
      <line [attr.x1]="50" [attr.y1]="i + 12.5" [attr.x2]="50" [attr.y2]="i + 25" class="brick" />
      } @else {
      <!-- ODD -->
      <line [attr.x1]="25" [attr.y1]="i" [attr.x2]="25" [attr.y2]="i + 12.5" class="brick" />
      } }
    </pattern>
    }
  </defs>

  @if(wallPosition === 'l') {
  <polygon [attr.points]="svgPolygonPoints[0]" [attr.fill]="wallTexture" />
  } @if(wallPosition === 'r') {
  <polygon [attr.points]="svgPolygonPoints[1]" [attr.fill]="wallTexture" />
  }
</svg>