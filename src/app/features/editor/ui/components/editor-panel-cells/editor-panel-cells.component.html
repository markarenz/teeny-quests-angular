<app-collapsible-card
  title="Map Cells"
  [defaultOpen]="true"
  (onCollapse)="handleCellDeselect()"
>
  <div class="flex flex-col gap-8">
    <div class="flex flex-col gap-4">
      <div class="flex items-center justify-between">
        <label>
          Selected Cell:
          {{
            selectedCellPosition
              ? selectedCellPosition.replace("_", ", ")
              : "None"
          }}
        </label>
        <div class="flex flex-row gap-4">
          @if(selectedCellPosition) {
          <button
            type="button"
            role="button"
            (click)="handleCellDeselect()"
            class="rounded-md"
          >
            Deselect
          </button>
          }
          <button
            type="button"
            role="button"
            class="rounded-full w-10 h-10 flex items-center justify-center"
            [attr.aria-label]="
              isCellSelectorOpen ? 'Hide Selector' : 'Show Selector'
            "
            (click)="handleToggleCellSelector()"
          >
            <div
              class="transition-all duration-300 w-4 h-4 {{
                isCellSelectorOpen ? 'rotate-180' : 'rotate-90'
              }}"
            >
              <app-icon-caret />
            </div>
          </button>
        </div>
      </div>

      @if(isCellSelectorOpen) {
      <app-area-cell-selector
        id="editor-cell-selector"
        [selectedCellPosition]="selectedCellPosition"
      />
      }
    </div>

    @if(selectedCellPosition && selectedCell) {
    <div class="flex flex-col gap-4">
      <label> Set Height </label>
      <div
        id="input-editor-panel-cells-height"
        class="flex flex-row justify-between items-center max-w-[200px] w-full mx-auto"
      >
        @for(item of buttons; track item.direction) {
        <button
          class="height-button"
          [style.order]="item.direction === 'down' ? 1 : 3"
          (click)="handleCellHeightChange(item.direction)"
          [disabled]="
            item.direction === 'up'
              ? selectedCell.h >= maxHeight
              : selectedCell.h < 1
          "
          [attr.aria-label]="item.label"
        >
          <svg
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/"
            class="{{ item.direction === 'down' ? 'rotate-180' : null }}"
          >
            <polygon
              fill="var(--color-gray-200)"
              stroke="none"
              points="12 5 3 15 9 15 9 19 15 19 15 15 21 15 12 5"
            />
          </svg>
        </button>
        }
        <div [style.order]="2">
          {{ selectedCell.h }}
        </div>
      </div>
    </div>

    <div class="flex flex-col gap-4">
      <label>Floor: {{ currentFloorOption || "None" }}</label>
      <app-editor-texture-selector
        [options]="floorOptions"
        [selectedId]="selectedCell.floor"
        (onSelect)="handleFloorChange($event)"
      />
    </div>
    <div class="flex flex-col gap-4">
      <label>Wall Left: {{ currentWallLOption || "None" }}</label>
      <app-editor-texture-selector
        [options]="wallOptions"
        [selectedId]="selectedCell.wallSouth"
        (onSelect)="handleWallChange($event, 'south')"
      />
    </div>

    <div class="flex flex-col gap-4">
      <label>Wall Right: {{ currentWallROption || "None" }}</label>
      <app-editor-texture-selector
        [options]="wallOptions"
        [selectedId]="selectedCell.wallEast"
        (onSelect)="handleWallChange($event, 'east')"
      />
    </div>
    }
    <app-button
      [fullWidth]="true"
      label="Reset Textures"
      (click)="handleResetTexturesClick()"
    />
  </div>
</app-collapsible-card>
